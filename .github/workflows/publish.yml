name: docker_publish

on:
  push:
    branches:
    - '*'
    tags:
    - '*'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  # Liquidator Service
  docker_liquidator_indexer:
    uses: babylonlabs-io/.github/.github/workflows/reusable_docker_pipeline.yml@d2299e834fcbaca4bf2db043a2939798043d5951 # v0.16.1
    secrets: inherit
    with:
      publish: true
      dockerfile: ./docker/liquidator-ponder.Dockerfile
      repoName: liquidation-aave-indexer
      push_to_dockerhub: false
    permissions:
      contents: read
      id-token: write
      security-events: write
      packages: read

  docker_liquidator_client:
    uses: babylonlabs-io/.github/.github/workflows/reusable_docker_pipeline.yml@d2299e834fcbaca4bf2db043a2939798043d5951 # v0.16.1
    secrets: inherit
    with:
      publish: true
      dockerfile: ./docker/liquidator-client.Dockerfile
      repoName: liquidation-aave-client
      push_to_dockerhub: false
    permissions:
      contents: read
      id-token: write
      security-events: write
      packages: read

  # Arbitrageur Service
  docker_arbitrageur_indexer:
    uses: babylonlabs-io/.github/.github/workflows/reusable_docker_pipeline.yml@d2299e834fcbaca4bf2db043a2939798043d5951 # v0.16.1
    secrets: inherit
    with:
      publish: true
      dockerfile: ./docker/arbitrageur-ponder.Dockerfile
      repoName: arbitrageur-aave-indexer
      push_to_dockerhub: false
    permissions:
      contents: read
      id-token: write
      security-events: write
      packages: read

  docker_arbitrageur_client:
    uses: babylonlabs-io/.github/.github/workflows/reusable_docker_pipeline.yml@d2299e834fcbaca4bf2db043a2939798043d5951 # v0.16.1
    secrets: inherit
    with:
      publish: true
      dockerfile: ./docker/arbitrageur-client.Dockerfile
      repoName: arbitrageur-aave-client
      push_to_dockerhub: false
    permissions:
      contents: read
      id-token: write
      security-events: write
      packages: read
